{"version":3,"sources":["../src/routes.js"],"names":["router","get","req","res","address","params","toLowerCase","client","err","value","logger","error","send","info","data","JSON","stringify","parse"],"mappings":";;;;;;;;;;;;;;AAAA;;AACA;;AACA;;;;;;kBAEe,UAACA,MAAD,EAAY;AACvBA,SAAOC,GAAP,CAAW,WAAX;AAAA,wFAAwB,kBAAOC,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAChBC,qBADgB,GACNF,IAAIG,MAAJ,CAAWD,OAAX,CAAmBE,WAAnB,EADM;;AAEtBC,4BAAON,GAAP,CAAWG,OAAX;AAAA,qGAAoB,iBAAOI,GAAP,EAAWC,KAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,+BACdD,GADc;AAAA;AAAA;AAAA;;AAEhBE,4CAAOC,KAAP,CAAa,KAAb;AACAR,8BAAIS,IAAJ,CAASJ,GAAT;AAHgB,gCAIVA,GAJU;;AAAA;AAAA,gCAKRC,UAAU,IALF;AAAA;AAAA;AAAA;;AAMhBC,4CAAOG,IAAP,CAAY,sBAAZ;AANgB;AAAA,iCAOG,yBAAUT,OAAV,CAPH;;AAAA;AAOVU,8BAPU;;AAQhB,2CAAKV,OAAL,EAAcW,KAAKC,SAAL,CAAeF,IAAf,CAAd;AACAX,8BAAIS,IAAJ,CAASE,IAAT;AATgB;AAAA;;AAAA;AAWhBJ,4CAAOG,IAAP,CAAY,yBAAZ;AACAV,8BAAIS,IAAJ,CAASG,KAAKE,KAAL,CAAWR,KAAX,CAAT;;AAZgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAApB;;AAAA;AAAA;AAAA;AAAA;;AAFsB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAxB;;AAAA;AAAA;AAAA;AAAA;AAkBH,C","file":"routes.js","sourcesContent":["import { client, save } from './config/cache';\nimport { fetchData } from './config/livepeer'\nimport logger from './config/winston';\n\nexport default (router) => {\n    router.get('/:address', async (req, res) => {\n      const address = req.params.address.toLowerCase()\n      client.get(address, async (err,value) => {\n        if (err) {\n          logger.error(\"ERR\")\n          res.send(err)\n          throw err\n        } else if(value === null) {\n          logger.info(\"ADDING USER TO CACHE\")\n          const data = await fetchData(address)\n          save(address, JSON.stringify(data));\n          res.send(data)\n        } else {\n          logger.info(\"USER FETCHED FROM CACHE\")\n          res.send(JSON.parse(value));\n        }\n      });\n    })\n}"]}